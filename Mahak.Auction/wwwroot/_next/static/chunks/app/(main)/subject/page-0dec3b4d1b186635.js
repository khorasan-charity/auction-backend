(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[978],{18808:function(e,t,n){Promise.resolve().then(n.bind(n,63658))},63658:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return P}});var a=n(3827),l=n(64339),r=n(94642),s=n(64090),o=n(23183),i=n(44651),u=n(75504),c=n(82726),d=()=>{let[e,t]=(0,s.useState)(null),[n,d]=(0,s.useState)(0),[m,x]=(0,s.useState)(2e6),[f,g]=(0,s.useState)(2),[h,v]=(0,s.useState)(1e7),[p,y]=(0,s.useState)(4),[j,b]=(0,s.useState)(8),{data:w}=(0,r.a)({queryKey:["get-payment"],queryFn:l._P,refetchInterval:1e3}),{data:N}=(0,r.a)({queryKey:["get-settings"],queryFn:c.G,refetchInterval:1e3});return(0,s.useEffect)(()=>{let e=null==w?void 0:w.items[0];d(n=>(((null==w?void 0:w.totalCount)||0)>n&&(t(e),setTimeout(()=>{t(null)},e.amount>=h?1e3*j:e.amount>=m?1e3*p:1e3*f)),(null==w?void 0:w.totalCount)||0))},[w]),(0,s.useEffect)(()=>{var e,t,n,a,l;(null==N?void 0:N.normalPaymentMaximum)&&x(parseInt(null!==(e=null==N?void 0:N.normalPaymentMaximum)&&void 0!==e?e:"0")),(null==N?void 0:N.normalPaymentDuration)&&g(parseInt(null!==(t=null==N?void 0:N.normalPaymentDuration)&&void 0!==t?t:"0")),(null==N?void 0:N.silverPaymentMaximum)&&v(parseInt(null!==(n=null==N?void 0:N.silverPaymentMaximum)&&void 0!==n?n:"0")),(null==N?void 0:N.silverPaymentDuration)&&y(parseInt(null!==(a=null==N?void 0:N.silverPaymentDuration)&&void 0!==a?a:"0")),(null==N?void 0:N.goldPaymentDuration)&&b(parseInt(null!==(l=null==N?void 0:N.goldPaymentDuration)&&void 0!==l?l:"0"))},[N]),e&&(0,a.jsx)("div",{className:"fixed top-0 left-0 w-screen h-screen flex justify-center items-center z-[100] select-none",children:(0,a.jsx)(o.E.div,{className:(0,u.Z)("bg-gradient-to-br shadow-lg p-32 rounded-3xl border-8 w-[90vw] flex flex-row items-center justify-center",e.amount>=h?"from-yellow-300 via-yellow-600 to-yellow-500 border-yellow-300":e.amount>=m?"from-gray-500 via-gray-600 to-gray-400 border-gray-200":"from-green-500 via-green-600 to-green-400 border-green-300"),animate:{x:[-1800,0,0,0,1800],scale:[.2,1,1.2,1,.2]},transition:{duration:e.amount>=h?j:e.amount>=m?p:f,ease:"easeInOut",times:[0,.2,.5,.8,1],repeat:1/0,repeatDelay:1},children:(0,a.jsx)(i.Z,{amount:e.amount,currencyClassName:"text-[4vw]",className:"font-extrabold text-[10vw] text-left text-white"})})})},m=n(29891),x=n(73031),f=n(51055),g=n(53718),h=n(77599);let v={green:"from-green-400 to-green-600",sky:"from-sky-500 to-sky-800",neutral:"from-neutral-600 to-neutral-800"};var p=e=>{var t;return(0,a.jsxs)(m.w,{className:"w-full overflow-visible shadow-none col-span-12 sm:col-span-6 md:col-span-4 lg:col-span-4 xl:col-span-3 border-none bg-gradient-to-br ".concat(e.progress?e.progress<100?v.sky:v.green:v.neutral),children:[(0,a.jsx)(x.u,{className:"w-full flex justify-center items-center",children:(0,a.jsx)("strong",{className:"text-lg font-bold text-white text-center",children:e.title})}),(0,a.jsx)(f.G,{className:"flex justify-center items-center pb-0",children:(0,a.jsx)(g.Z,{classNames:{svg:"w-36 h-36 drop-shadow-md",indicator:"stroke-white",track:"stroke-white/10",value:"text-3xl font-semibold text-white"},value:null!==(t=e.progress)&&void 0!==t?t:0,strokeWidth:4,showValueLabel:!0})}),(0,a.jsx)(h.i,{className:"flex justify-center items-center pt-5 text-white",children:(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,a.jsx)(i.Z,{amount:e.collectedAmount}),(0,a.jsx)("span",{children:"از"}),(0,a.jsx)(i.Z,{amount:e.targetAmount})]})})]})},y=n(94832),j=n(91341),b=n(71704),w=n(78441),N=()=>(0,a.jsx)(j.Z,{children:(0,a.jsxs)("div",{className:"w-full flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.Z,{}),(0,a.jsx)("strong",{className:"text-lg lg:text-xl font-bold truncate line-clamp-1",children:"موسسه حمایت از کودکان مبتلا به سرطان خراسان"})]}),(0,a.jsx)(w.Z,{})]})}),Z=e=>{let{totalPayment:t,totalPaymentCount:n,targetAmount:l,progress:r,surplus:s}=e;return(0,a.jsx)(j.Z,{className:"overflow-hidden text-center py-0 px-2",children:(0,a.jsxs)("div",{className:"w-full flex flex-row justify-between p-3",children:[(0,a.jsxs)("div",{className:"flex flex-col justify-between gap-y-4",children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-white text-xl",children:"مبلغ جمع‌آوری شده"}),(0,a.jsx)(i.Z,{amount:t,className:"font-extrabold text-5xl text-indigo-600 dark:text-indigo-300",currencyClassName:"text-lg"})]}),(0,a.jsxs)("div",{className:"flex flex-col justify-between gap-y-4",children:[(0,a.jsx)("span",{className:"text-neutral-600 dark:text-white text-xl",children:"تعداد مشارکت"}),(0,a.jsx)(i.Z,{amount:n,className:"font-extrabold text-5xl text-indigo-600 dark:text-indigo-300",currencyClassName:"text-lg",currency:"نفر"})]})]})})},k=n(79454),S=n(77132),C=n.n(S),I=n(34622),D=()=>{let[e,t]=(0,s.useState)([]),[n,o]=(0,s.useState)(0),[i,u]=(0,s.useState)(0),[d,m]=(0,s.useState)(0),[x,f]=(0,s.useState)(0),[g,h]=(0,s.useState)(!1),[v,j]=(0,s.useState)(0),[b,w]=(0,s.useState)(5),[S,D]=(0,s.useState)(void 0),[P,q]=(0,s.useState)([]),[E,A]=(0,s.useState)(!1),{data:F=0}=(0,r.a)({queryKey:["get-totalPayment"],queryFn:l.uq,enabled:e&&e.length>0,refetchInterval:1e3}),{data:M=0}=(0,r.a)({queryKey:["get-totalContributionCount"],queryFn:l.Jg,enabled:e&&e.length>0,refetchInterval:1e3}),{data:_}=(0,r.a)({queryKey:["get-settings"],queryFn:c.G,refetchInterval:1e3}),K=(0,s.useCallback)(e=>q(e.filter(e=>{let{kind:t}=e;return"videoinput"===t})),[q]);return(0,s.useEffect)(()=>{navigator.mediaDevices.enumerateDevices().then(K)},[K]),(0,s.useEffect)(()=>{k.Z.getSubject().then(e=>{t(e.items),f(e.items.reduce((e,t)=>e+=t.targetAmount,0))})},[]),(0,s.useEffect)(()=>{var e,t;(null==_?void 0:_.camera)&&h((null==_?void 0:_.camera)=="on"),(null==_?void 0:_.autoCameraDuration)&&j(parseInt(null!==(e=null==_?void 0:_.autoCameraDuration)&&void 0!==e?e:"0")),(null==_?void 0:_.confettiDuration)&&w(parseInt(null!==(t=null==_?void 0:_.confettiDuration)&&void 0!==t?t:"0"))},[_]),(0,s.useEffect)(()=>{t(function(e){let t=e.reduce((e,t)=>e+=t.targetAmount,0);f(t),t>0?u(Math.floor(F/t*100)):u(0),m(F>t?F-t:0);let n=F,a=0;return e.forEach(e=>{n>=e.targetAmount?(n-=e.targetAmount,e.progress=100,e.collectedAmount=e.targetAmount,a++):n>0?(e.progress=Math.floor(n/e.targetAmount*100),e.collectedAmount=n,n=0):(e.progress=0,e.collectedAmount=0)}),o(e=>{if(a>e){let e=0,t=setInterval(()=>{(0,y.Z)({particleCount:10,scalar:4,angle:-35,spread:100,origin:{x:0,y:0}}),(0,y.Z)({particleCount:10,scalar:4,angle:220,spread:100,origin:{x:1,y:0}}),++e>10*b&&clearInterval(t)},100);v>0&&(h(!0),setTimeout(()=>{h(!1)},1e3*v))}return a}),e}(e.map(e=>({...e}))))},[F]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"sticky top-0 inset-y-0 z-2 flex flex-col gap-2 bg-gray-100 dark:bg-neutral-900",children:[(0,a.jsx)(N,{}),(0,a.jsx)(Z,{surplus:d,progress:i,totalPayment:F,totalPaymentCount:M,targetAmount:x})]}),g?(0,a.jsxs)("div",{className:"flex flex-col justify-center items-center",children:[(0,a.jsx)(C(),{className:"rounded-xl w-full",mirrored:!0,videoConstraints:{facingMode:"environment",deviceId:S},onDoubleClick:()=>A(e=>!e)}),E?(0,a.jsx)("div",{className:"flex flex-col gap-y-2 mt-2",children:P.map((e,t)=>(0,a.jsx)(I.A,{color:"success",onClick:()=>D(e.deviceId),children:e.label||"Device ".concat(t+1)}))}):null]}):(0,a.jsx)("div",{className:"w-full grid grid-cols-12 gap-4 h-[calc(100vh-15.5rem)] overflow-y-auto px-1",children:null==e?void 0:e.map(e=>(0,a.jsx)(p,{...e},e.id))})]})};async function P(){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("section",{className:"flex flex-col gap-4 w-full h-full items-stretch pt-3",children:(0,a.jsx)(D,{})}),(0,a.jsx)(d,{})]})}},72344:function(e,t,n){"use strict";let a=n(73107).Z.create({baseURL:"/api/app",headers:{"Content-Type":"application/json"}}),l={get:a.get,post:a.post,delete:a.delete,put:a.put,patch:a.patch};t.Z=l},64339:function(e,t,n){"use strict";n.d(t,{Jg:function(){return i},KX:function(){return r},_P:function(){return l},bi:function(){return s},uq:function(){return o}});var a=n(72344);let l=()=>a.Z.get("/payment?Sorting=CreationTime%20DESC").then(e=>e.data),r=e=>a.Z.post("/payment",e).then(e=>e.data),s=e=>a.Z.delete("/payment/".concat(e)).then(e=>e.data),o=()=>a.Z.get("/payment/total").then(e=>e.data),i=()=>a.Z.get("/payment/contribution-count").then(e=>e.data)},82726:function(e,t,n){"use strict";n.d(t,{G:function(){return l},L:function(){return r}});var a=n(72344);async function l(){return(await a.Z.get("/settings/settings")).data}async function r(e,t){return(await a.Z.post("/settings/set?key=".concat(e,"&value=").concat(t))).data}},79454:function(e,t,n){"use strict";var a=n(72344);t.Z={getSubject:async()=>(await a.Z.get("/subject?skipCount=0&maxResultCount=1000")).data,addSubject:async e=>(await a.Z.post("/subject",e)).data,updateSubject:async e=>(await a.Z.put("/subject/".concat(e.id),e)).data,deleteSubject:async e=>(await a.Z.delete("/subject/".concat(e))).data}},91341:function(e,t,n){"use strict";var a=n(3827),l=n(51367);let r=e=>{let{children:t,className:n,...r}=e;return(0,a.jsx)("div",{className:(0,l.m6)("px-5 py-4 w-full bg-white dark:bg-neutral-800 border border-gray-200 dark:border-neutral-700 transition-all duration-400 rounded-xl",n),...r,children:t})};r.Body=e=>{let{children:t,className:n="",...r}=e;return(0,a.jsx)("div",{className:(0,l.m6)("w-full mt-4 lg:mt-7",n),...r,children:t})},r.Title=e=>{let{children:t,className:n="",...r}=e;return(0,a.jsxs)("div",{className:(0,l.m6)("flex justify-center w-fit items-center gap-2",n),...r,children:[(0,a.jsx)("span",{className:"rounded-full w-1.5 h-1.5 md:w-2 md:h-2 transition-all bg-secondary-600 dark:bg-secondary-500"}),(0,a.jsx)("strong",{className:"text-base md:text-lg xl:text-xl text-secondary-600 dark:text-secondary-500 transition-colors font-bold",children:t})]})},r.Header=e=>{let{children:t,className:n="",...r}=e;return(0,a.jsx)("div",{className:(0,l.m6)("flex justify-between items-center gap-2",n),...r,children:t})},t.Z=r},71704:function(e,t,n){"use strict";var a=n(3827);t.Z=()=>(0,a.jsx)("div",{className:"w-12 h-12",children:(0,a.jsx)("img",{src:"/logo.png",alt:"logo",title:"logo",className:"w-full h-full object-cover",width:100,height:100})})},44651:function(e,t,n){"use strict";var a=n(3827),l=n(82726),r=n(54259),s=n(94642);t.Z=e=>{var t,n,o,i;let{data:u}=(0,s.a)({queryKey:["get-settings"],queryFn:l.G,refetchInterval:1e3});return(0,a.jsxs)("strong",{className:null!==(t=e.className)&&void 0!==t?t:"font-bold text-xl",children:[(0,r.f)(null!==(n=e.amount)&&void 0!==n?n:0,void 0,(null==u?void 0:u.showMoneyShorter)=="true"),"\xa0",(0,a.jsx)("span",{className:null!==(o=e.currencyClassName)&&void 0!==o?o:"font-normal text-sm",children:null!==(i=e.currency)&&void 0!==i?i:"تومان"})]})}},78441:function(e,t,n){"use strict";var a=n(3827),l=n(6613),r=n(38580),s=n(91774),o=n(51367),i=n(56733);t.Z=e=>{let{className:t,classNames:n}=e,{theme:u,setTheme:c}=(0,s.F)(),{Component:d,slots:m,isSelected:x,getBaseProps:f,getInputProps:g,getWrapperProps:h}=(0,r.h)({isSelected:"light"===u,onChange:()=>{"light"===u?c("dark"):c("light")}});return(0,a.jsxs)(d,{...f({className:(0,o.m6)("px-px transition-opacity hover:opacity-80 cursor-pointer",t,null==n?void 0:n.base)}),children:[(0,a.jsx)(l.T,{children:(0,a.jsx)("input",{...g()})}),(0,a.jsx)("div",{...h(),className:m.wrapper({class:(0,o.m6)(["w-auto h-auto","bg-transparent","rounded-lg","flex items-center justify-center","group-data-[selected=true]:bg-transparent","!text-default-500","pt-px","px-0","mx-0"],null==n?void 0:n.wrapper)}),children:x?(0,a.jsx)(i.Fxr,{className:"w-6 h-6"}):(0,a.jsx)(i.YGJ,{className:"w-6 h-6"})})]})}},54259:function(e,t,n){"use strict";n.d(t,{f:function(){return a}});let a=(e,t,n)=>{if(t||(t=""),isNaN(e))return"0 ".concat(t.trim()).trimEnd();let a=new Intl.NumberFormat().format(e);return n&&(a.length<16&&a.endsWith(",000,000,000")?a=a.substring(0,a.length-12)+" میلیارد":a.length<12&&a.endsWith(",000,000")?a=a.substring(0,a.length-8)+" میلیون":a.length<8&&a.endsWith(",000")&&(a=a.substring(0,a.length-4)+" هزار")),"".concat(a,"  ").concat(t.trim()).trimEnd()}}},function(e){e.O(0,[516,224,377,642,800,415,343,183,760,622,729,822,655,408,971,69,744],function(){return e(e.s=18808)}),_N_E=e.O()}]);